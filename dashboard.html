<html lang="en">

<head>
    <!-- The head element reference this : https://getbootstrap.com/docs/5.3/getting-started/introduction/ -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dashboard for the developer and game admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
</head>

<body>
    <div class="container text-center information col p-3  mt-4">
        <!-- reference: https://getbootstrap.com/docs/5.3/layout/grid/ -->
        <div class="grid api-calls">
            <!-- reference for buttons: https://getbootstrap.com/docs/5.3/components/buttons/ -->
            <div class="row">
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
            </div>
            <div class="row">
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
            </div>
            <div class="row">
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
            </div>
            <div class="row">
                <div class="col"><a role="button" class="btn btn-primary m-1">button</a></div>
                <div class="col"><a role="button" class="btn btn-primary m-1">expand time</a></div>
                <div class="col"><a href="game/start/easy" target="_blank" role="button"
                        class="btn btn-primary m-1">start game</a></div>
            </div>
        </div>
        <div class="row p-2 border" id="timeInfo">
            <div class="col time" id="startTime">2023/4/26 11:40:00</div>
            <div class="col time" id="endTime">2023/4/26 11:50:00</div>
            <div class="col time" id="remainingTime">600</div>
            <script>
                const remainingTime = document.getElementById("remainingTime")
                setInterval(() => {
                    remainingTime.innerText = parseInt(remainingTime.innerText) - 1
                }, 1000);
            </script>
            <div class="col">
                <button type="button" class="btn btn-primary">Base class</button>
                <!-- button referencehttps://getbootstrap.com/docs/5.3/components/buttons/ -->
            </div>
        </div>
        <div class="row p-2 border mt-2">
            <div class="col">
                <div class="row info" id="energycoreInfo">
                    <h2>energy cores</h2>
                    <table class="table infotable" id="energycoreInfoTable">
                        <!-- https://getbootstrap.com/docs/5.3/content/tables/ -->
                        <thead id="energycoreInfoThead">
                            <tr>
                                <th scope="col">id</th>
                                <th scope="col">state</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="d-none" id="energycore-tr-template">
                                <th class="energycore-th" scope="row">1</th>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="row info" id="treasureInfo">
                    <h2>treasure</h2>
                    <table class="table infotable" id="treasureInfoTable">
                        <!-- https://getbootstrap.com/docs/5.3/content/tables/ -->
                        <thead id="treasureInfoThead">
                            <tr>
                                <th scope="col">id</th>
                                <th scope="col">state</th>
                                <th scope="col">type</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="d-none" id="treasure-tr-template">
                                <th class="treasure-th" scope="row">1</th>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
        let _data;
        async function loadGameJSONData() {
            // reference: https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch
            const response = await fetch('game/info?json=1')
            const gameJSONData = await response.json();
            return JSON.parse(gameJSONData)
        }
        function renderEnergycores(energycoresData) {
            const thead = document.getElementById("energycoreInfoThead");
            thead.innerHTML=""
            energycoresData.forEach(energycore => {
                let tr = document.createElement("tr");
                tr.className="";
                tr.id=`energycore-tr-${energycore.id}`;
                tr.innerHTML=`<th class="energycore-th" scope="row">${energycore.id}</th><td>${energycore.state}</td>`;
                thead.appendChild(tr);
            });
        }
        function renderTreasures(treasuresData) {
            const thead = document.getElementById("treasureInfoThead");
            thead.innerHTML=""
            treasuresData.forEach(treasure => {
                let tr = document.createElement("tr");
                tr.className="";
                tr.id=`treasure-tr-${treasure.id}`;
                tr.innerHTML=`<th class="treasure-th" scope="row">${treasure.id}</th><td>${treasure.state}</td><td>${treasure.type}</td>`;
                thead.appendChild(tr);
            });
        }
        function renderData(data) {
            _data = data
            renderEnergycores(data.energycores)
            renderTreasures(data.treasures)
            // renderquizzes(data.quizzes)
        }
        async function main() {
            setInterval(async () => {
                const data = await loadGameJSONData()
                renderData(data)
            }, 3000);
        }
        main()
    </script>
</body>

</html>